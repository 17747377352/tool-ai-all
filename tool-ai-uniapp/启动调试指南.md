# 前端项目启动调试指南

## 方式一：使用 HBuilderX（推荐）

### 1. 安装 HBuilderX

1. 下载 HBuilderX：https://www.dcloud.io/hbuilderx.html
2. 安装 HBuilderX（建议使用正式版）

### 2. 导入项目

1. 打开 HBuilderX
2. 点击 `文件` → `导入` → `从本地目录导入`
3. 选择项目目录：`tool-ai-uniapp`
4. 点击 `选择`

### 3. 配置项目

#### 3.1 配置微信小程序 AppID

1. 打开 `manifest.json`
2. 找到 `mp-weixin` → `appid`
3. 修改为你的微信小程序 AppID：
   ```json
   "mp-weixin": {
       "appid": "你的微信小程序AppID"
   }
   ```

#### 3.2 配置后端API地址

1. 打开 `common/utils/request.js`
2. 修改 `baseUrl` 为你的后端服务地址：
   ```javascript
   const baseUrl = 'http://localhost:8080'; // 本地开发
   // 或
   const baseUrl = 'https://your-domain.com'; // 生产环境
   ```

#### 3.3 配置广告位ID（可选，调试时可跳过）

1. 打开 `common/utils/ad.js`
2. 修改广告位ID：
   ```javascript
   adUnitId: 'adunit-xxx' // 替换为实际广告位ID
   ```

### 4. 运行到微信开发者工具

1. 在 HBuilderX 中，点击顶部菜单 `运行` → `运行到小程序模拟器` → `微信开发者工具`
2. 首次运行会提示配置微信开发者工具路径：
   - Windows: `C:\Program Files (x86)\Tencent\微信web开发者工具\cli.bat`
   - Mac: `/Applications/wechatwebdevtools.app/Contents/MacOS/cli`
3. 点击 `运行` 后，HBuilderX 会自动编译并打开微信开发者工具

### 5. 在微信开发者工具中调试

1. 微信开发者工具会自动打开项目
2. **重要：配置域名白名单（必须）**
   - 点击右上角的 `详情` 按钮
   - 在 `本地设置` 标签页中
   - ✅ **勾选 `不校验合法域名、web-view（业务域名）、TLS 版本以及 HTTPS 证书`**
   - 这样开发环境才能正常请求后端接口
3. 点击 `编译` 按钮进行编译
4. 在模拟器中测试功能
5. 查看控制台日志进行调试

> ⚠️ **如果遇到 "url not in domain list" 错误，请查看 `快速修复域名错误.md`**

## 方式二：使用 CLI 方式（需要 Node.js）

### 1. 安装依赖

```bash
cd tool-ai-uniapp

# 如果项目有 package.json，安装依赖
npm install
# 或
yarn install
```

### 2. 安装 uni-app CLI

```bash
npm install -g @dcloudio/uvm
uvm
```

### 3. 运行项目

```bash
# 运行到微信小程序
npm run dev:mp-weixin

# 或使用 HBuilderX CLI
# 需要先安装 HBuilderX CLI
```

### 4. 在微信开发者工具中打开

1. 打开微信开发者工具
2. 选择 `导入项目`
3. 选择项目目录：`tool-ai-uniapp/dist/dev/mp-weixin`
4. 填写 AppID（测试号或正式号）
5. 点击 `导入`

## 调试技巧

### 1. 控制台调试

- **HBuilderX 控制台**：查看编译日志和错误信息
- **微信开发者工具控制台**：查看运行时日志
- **Network 面板**：查看网络请求

### 2. 断点调试

1. 在代码中设置 `debugger;`
2. 在微信开发者工具中打开 `调试器` → `Sources`
3. 刷新页面，程序会在断点处暂停

### 3. 查看网络请求

1. 打开微信开发者工具
2. 点击 `Network` 标签
3. 查看所有网络请求和响应

### 4. 查看存储数据

1. 打开微信开发者工具
2. 点击 `Storage` 标签
3. 查看 `localStorage` 中的数据（token、openid等）

## 常见问题

### 1. 编译错误

**问题**：编译时提示找不到模块或组件

**解决**：
- 检查文件路径是否正确
- 检查 `pages.json` 中的页面路径
- 检查组件导入路径

### 2. 网络请求失败

**问题**：请求后端接口失败

**解决**：
- 检查后端服务是否启动
- 检查 `request.js` 中的 `baseUrl` 是否正确
- 检查微信小程序是否配置了服务器域名白名单（开发环境可勾选"不校验合法域名"）

### 3. 登录失败

**问题**：微信登录失败

**解决**：
- 检查 `manifest.json` 中的 AppID 是否正确
- 检查后端微信配置（appid、secret）是否正确
- 检查后端服务是否正常运行

### 4. 广告组件报错

**问题**：广告组件加载失败

**解决**：
- 调试阶段可以暂时注释掉广告相关代码
- 检查广告位ID是否正确
- 确认小程序是否已开通广告功能

### 5. 页面空白

**问题**：页面显示空白

**解决**：
- 打开控制台查看错误信息
- 检查页面路径是否正确
- 检查组件是否正确导入

## 开发环境配置

### 1. 微信开发者工具设置

1. 打开微信开发者工具
2. 点击 `设置` → `项目设置`
3. 勾选以下选项：
   - ✅ **不校验合法域名、web-view（业务域名）、TLS 版本以及 HTTPS 证书**
     - **这是必须的！** 否则会出现 "url not in domain list" 错误
   - ✅ 启用自定义处理命令
   - ✅ 启用调试

> 📖 **如果遇到域名错误，请查看：`快速修复域名错误.md`**

### 2. 后端服务配置

确保后端服务已启动并运行在配置的端口（默认 8080）

### 3. 数据库配置

确保数据库已初始化（执行 `tool-ai-service/src/main/resources/sql/init.sql`）

## 调试步骤总结

1. ✅ 启动后端服务（确保端口与前端配置一致）
2. ✅ 配置 `manifest.json` 中的 AppID
3. ✅ 配置 `request.js` 中的后端地址
4. ✅ 在 HBuilderX 中运行到微信开发者工具
5. ✅ 在微信开发者工具中测试功能
6. ✅ 查看控制台和网络请求进行调试

## 快速启动命令（HBuilderX）

1. 打开项目：`文件` → `打开目录` → 选择 `tool-ai-uniapp`
2. 运行项目：`运行` → `运行到小程序模拟器` → `微信开发者工具`
3. 开始调试！

## 注意事项

1. **首次运行**：需要配置微信开发者工具路径
2. **网络请求**：开发环境需要勾选"不校验合法域名"
3. **图标资源**：需要准备图标文件（见项目说明.md）
4. **广告功能**：调试阶段可以暂时禁用广告相关代码
5. **后端服务**：确保后端服务已启动并可以访问

