{"version":3,"file":"constellation.js","sources":["pages/constellation/constellation.vue","pages/constellation/constellation.vue?type=page"],"sourcesContent":["<template>\n    <view class=\"container\">\n        <view class=\"header\">\n            <text class=\"title\">选择你的星座</text>\n            <text class=\"subtitle\">查看今日运势</text>\n        </view>\n\n        <view class=\"constellation-grid\">\n            <view\n                v-for=\"item in constellations\"\n                :key=\"item.name\"\n                class=\"constellation-item\"\n                :class=\"{ generating: generatingConstellation === item.name }\"\n                @click=\"selectConstellation(item.name)\"\n            >\n                <view class=\"constellation-icon\">\n                    <text class=\"icon-text\">{{ item.icon }}</text>\n                </view>\n                <text class=\"constellation-name\">{{ item.name }}</text>\n                <text class=\"constellation-date\">{{ item.date }}</text>\n            </view>\n        </view>\n\n        <!-- Banner广告 -->\n        <ad-video-banner />\n    </view>\n</template>\n\n<script>\nimport api from '@/common/utils/api.js';\nimport AdVideoBanner from '@/common/components/ad-video-banner.vue';\n\nexport default {\n    components: {\n        AdVideoBanner\n    },\n    data() {\n        return {\n            generatingConstellation: '',\n            constellations: [\n                { name: '白羊座', icon: '♈', date: '3.21-4.19' },\n                { name: '金牛座', icon: '♉', date: '4.20-5.20' },\n                { name: '双子座', icon: '♊', date: '5.21-6.21' },\n                { name: '巨蟹座', icon: '♋', date: '6.22-7.22' },\n                { name: '狮子座', icon: '♌', date: '7.23-8.22' },\n                { name: '处女座', icon: '♍', date: '8.23-9.22' },\n                { name: '天秤座', icon: '♎', date: '9.23-10.23' },\n                { name: '天蝎座', icon: '♏', date: '10.24-11.22' },\n                { name: '射手座', icon: '♐', date: '11.23-12.21' },\n                { name: '摩羯座', icon: '♑', date: '12.22-1.19' },\n                { name: '水瓶座', icon: '♒', date: '1.20-2.18' },\n                { name: '双鱼座', icon: '♓', date: '2.19-3.20' }\n            ]\n        };\n    },\n    methods: {\n        async selectConstellation(constellation) {\n            if (this.generatingConstellation) {\n                return; // 正在生成中，不允许重复点击\n            }\n\n            this.generatingConstellation = constellation;\n            \n            try {\n                uni.showLoading({\n                    title: '生成中...',\n                    mask: true\n                });\n\n                const res = await api.generateConstellationFortune({\n                    constellation: constellation\n                });\n\n                uni.hideLoading();\n                \n                if (res.code === 200) {\n                    uni.navigateTo({\n                        url: `/pages/result/result?type=5&resultUrl=${encodeURIComponent(res.data.resultUrl)}&title=${encodeURIComponent(constellation + '今日运势')}`\n                    });\n                } else {\n                    // 处理非200的响应（如429限流错误）\n                    // 注意：request.js 已经显示了 toast，这里再次显示确保用户能看到\n                    uni.showToast({\n                        title: res.message || '生成失败，请稍后再试',\n                        icon: 'none',\n                        duration: 3000\n                    });\n                }\n            } catch (e) {\n                uni.hideLoading();\n                console.error('生成失败', e);\n                // 从错误对象中提取错误信息\n                // request.js 已经显示了 toast，但这里再次显示确保用户能看到\n                const errorMessage = (e.data && e.data.message) || e.message || '生成失败，请稍后再试';\n                uni.showToast({\n                    title: errorMessage,\n                    icon: 'none',\n                    duration: 3000\n                });\n            } finally {\n                this.generatingConstellation = '';\n            }\n        }\n    }\n};\n</script>\n\n<style scoped>\n.container {\n    min-height: 100vh;\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    padding: 40rpx 30rpx;\n}\n\n.header {\n    text-align: center;\n    margin-bottom: 50rpx;\n}\n\n.title {\n    display: block;\n    font-size: 40rpx;\n    font-weight: bold;\n    color: #fff;\n    margin-bottom: 15rpx;\n}\n\n.subtitle {\n    display: block;\n    font-size: 26rpx;\n    color: rgba(255, 255, 255, 0.8);\n}\n\n.constellation-grid {\n    display: grid;\n    grid-template-columns: repeat(3, 1fr);\n    gap: 20rpx;\n    margin-bottom: 100rpx;\n}\n\n.constellation-item {\n    background: #fff;\n    border-radius: 20rpx;\n    padding: 30rpx 20rpx;\n    text-align: center;\n    box-shadow: 0 4rpx 20rpx rgba(0, 0, 0, 0.1);\n    transition: transform 0.3s;\n}\n\n.constellation-item:active {\n    transform: scale(0.95);\n}\n\n.constellation-item.generating {\n    opacity: 0.6;\n    pointer-events: none;\n}\n\n.constellation-icon {\n    width: 80rpx;\n    height: 80rpx;\n    margin: 0 auto 15rpx;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    border-radius: 50%;\n    position: relative;\n}\n\n.icon-text {\n    font-size: 40rpx;\n    color: #fff;\n    line-height: 1;\n    text-align: center;\n    display: inline-block;\n    vertical-align: middle;\n    margin: 0;\n    padding: 0;\n}\n\n.constellation-name {\n    display: block;\n    font-size: 28rpx;\n    color: #333;\n    font-weight: 500;\n    margin-bottom: 8rpx;\n}\n\n.constellation-date {\n    display: block;\n    font-size: 22rpx;\n    color: #999;\n}\n</style>\n\n","import MiniProgramPage from '/Users/gongxuesong/Work/individual/工具/tool-ai-all/tool-ai-uniapp/pages/constellation/constellation.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni","api"],"mappings":";;;AA8BA,MAAO,gBAAe,MAAW;AAEjC,MAAK,YAAU;AAAA,EACX,YAAY;AAAA,IACR;AAAA,EACH;AAAA,EACD,OAAO;AACH,WAAO;AAAA,MACH,yBAAyB;AAAA,MACzB,gBAAgB;AAAA,QACZ,EAAE,MAAM,OAAO,MAAM,KAAK,MAAM,YAAa;AAAA,QAC7C,EAAE,MAAM,OAAO,MAAM,KAAK,MAAM,YAAa;AAAA,QAC7C,EAAE,MAAM,OAAO,MAAM,KAAK,MAAM,YAAa;AAAA,QAC7C,EAAE,MAAM,OAAO,MAAM,KAAK,MAAM,YAAa;AAAA,QAC7C,EAAE,MAAM,OAAO,MAAM,KAAK,MAAM,YAAa;AAAA,QAC7C,EAAE,MAAM,OAAO,MAAM,KAAK,MAAM,YAAa;AAAA,QAC7C,EAAE,MAAM,OAAO,MAAM,KAAK,MAAM,aAAc;AAAA,QAC9C,EAAE,MAAM,OAAO,MAAM,KAAK,MAAM,cAAe;AAAA,QAC/C,EAAE,MAAM,OAAO,MAAM,KAAK,MAAM,cAAe;AAAA,QAC/C,EAAE,MAAM,OAAO,MAAM,KAAK,MAAM,aAAc;AAAA,QAC9C,EAAE,MAAM,OAAO,MAAM,KAAK,MAAM,YAAa;AAAA,QAC7C,EAAE,MAAM,OAAO,MAAM,KAAK,MAAM,YAAY;AAAA,MAChD;AAAA;EAEP;AAAA,EACD,SAAS;AAAA,IACL,MAAM,oBAAoB,eAAe;AACrC,UAAI,KAAK,yBAAyB;AAC9B;AAAA,MACJ;AAEA,WAAK,0BAA0B;AAE/B,UAAI;AACAA,sBAAAA,MAAI,YAAY;AAAA,UACZ,OAAO;AAAA,UACP,MAAM;AAAA,QACV,CAAC;AAED,cAAM,MAAM,MAAMC,iBAAG,IAAC,6BAA6B;AAAA,UAC/C;AAAA,QACJ,CAAC;AAEDD,sBAAG,MAAC,YAAW;AAEf,YAAI,IAAI,SAAS,KAAK;AAClBA,wBAAAA,MAAI,WAAW;AAAA,YACX,KAAK,yCAAyC,mBAAmB,IAAI,KAAK,SAAS,CAAC,UAAU,mBAAmB,gBAAgB,MAAM,CAAC;AAAA,UAC5I,CAAC;AAAA,eACE;AAGHA,wBAAAA,MAAI,UAAU;AAAA,YACV,OAAO,IAAI,WAAW;AAAA,YACtB,MAAM;AAAA,YACN,UAAU;AAAA,UACd,CAAC;AAAA,QACL;AAAA,MACJ,SAAS,GAAG;AACRA,sBAAG,MAAC,YAAW;AACfA,sBAAA,MAAA,MAAA,SAAA,+CAAc,QAAQ,CAAC;AAGvB,cAAM,eAAgB,EAAE,QAAQ,EAAE,KAAK,WAAY,EAAE,WAAW;AAChEA,sBAAAA,MAAI,UAAU;AAAA,UACV,OAAO;AAAA,UACP,MAAM;AAAA,UACN,UAAU;AAAA,QACd,CAAC;AAAA,MACL,UAAU;AACN,aAAK,0BAA0B;AAAA,MACnC;AAAA,IACJ;AAAA,EACJ;AACJ;;;;;;;;;;;;;;;;;;;;ACvGA,GAAG,WAAW,eAAe;"}