{"version":3,"file":"ai-avatar.js","sources":["pages/ai-avatar/ai-avatar.vue","pages/ai-avatar/ai-avatar.vue?type=page"],"sourcesContent":["<template>\n    <view class=\"container\">\n        <!-- Ê®°ÂºèÈÄâÊã© -->\n        <view class=\"form-item\">\n            <text class=\"label\">ÁîüÊàêÊ®°Âºè</text>\n            <view class=\"mode-options\">\n                <view\n                    class=\"mode-item\"\n                    :class=\"{ active: mode === 'text' }\"\n                    @click=\"mode = 'text'\"\n                >\n                    <text>Â≠óÁîüÂõæ</text>\n                </view>\n                <view\n                    class=\"mode-item\"\n                    :class=\"{ active: mode === 'image' }\"\n                    @click=\"mode = 'image'\"\n                >\n                    <text>ÂõæÁîüÂõæ</text>\n                </view>\n            </view>\n        </view>\n\n        <!-- ÂõæÁîüÂõæÊ®°ÂºèÔºöÂõæÁâá‰∏ä‰º† -->\n        <view v-if=\"mode === 'image'\" class=\"form-item\">\n            <text class=\"label\">‰∏ä‰º†ÂõæÁâá</text>\n            <view class=\"upload-area\" @click=\"chooseImage\">\n                <image v-if=\"imageUrl\" :src=\"imageUrl\" class=\"preview-image\" mode=\"aspectFit\"></image>\n                <view v-else class=\"upload-placeholder\">\n                    <text class=\"upload-icon\">üì∑</text>\n                    <text class=\"upload-text\">ÁÇπÂáªÈÄâÊã©ÂõæÁâá</text>\n                </view>\n            </view>\n        </view>\n\n        <!-- ÁîüÊàêÊèêÁ§∫ËØç -->\n        <view class=\"form-item\">\n            <text class=\"label\">ÁîüÊàêÊèêÁ§∫ËØç</text>\n            <textarea\n                v-model=\"prompt\"\n                class=\"textarea\"\n                :placeholder=\"mode === 'image' ? '‰æãÂ¶ÇÔºöÂ∞ÜËøô‰∏™Â§¥ÂÉèËΩ¨Êç¢‰∏∫Âç°ÈÄöÈ£éÊ†º' : '‰æãÂ¶ÇÔºö‰∏Ä‰∏™ÂèØÁà±ÁöÑÂç°ÈÄöÂ§¥ÂÉèÔºåËìùËâ≤ËÉåÊôØ'\"\n                maxlength=\"200\"\n            ></textarea>\n        </view>\n\n        <!-- ÈÄâÊã©È£éÊ†º -->\n        <view class=\"form-item\">\n            <text class=\"label\">ÈÄâÊã©È£éÊ†º</text>\n            <view class=\"style-options\">\n                <view\n                    v-for=\"style in styles\"\n                    :key=\"style.value\"\n                    class=\"style-item\"\n                    :class=\"{ active: selectedStyle === style.value }\"\n                    @click=\"selectedStyle = style.value\"\n                >\n                    <text>{{ style.label }}</text>\n                </view>\n            </view>\n        </view>\n\n        <button \n            class=\"generate-btn\" \n            :disabled=\"!prompt || (mode === 'image' && !imageUrl) || generating\" \n            @click=\"generate\"\n        >\n            {{ generating ? 'ÁîüÊàê‰∏≠...' : 'Á´ãÂç≥ÁîüÊàê' }}\n        </button>\n\n        <!-- BannerÂπøÂëä -->\n        <ad-video-banner />\n    </view>\n</template>\n\n<script>\nimport api from '@/common/utils/api.js';\nimport apiConfig from '@/common/config/api-config.js';\nimport AdVideoBanner from '@/common/components/ad-video-banner.vue';\n\nexport default {\n    components: {\n        AdVideoBanner\n    },\n    data() {\n        return {\n            mode: 'text', // 'text' Â≠óÁîüÂõæ, 'image' ÂõæÁîüÂõæ\n            imageUrl: '', // ‰∏ä‰º†ÁöÑÂõæÁâáURLÔºàÂõæÁîüÂõæÊ®°ÂºèÔºâ\n            imageTempPath: '', // ‰∏¥Êó∂ÂõæÁâáË∑ØÂæÑÔºàÁî®‰∫éÈ¢ÑËßàÔºâ\n            prompt: '',\n            selectedStyle: 'realistic',\n            styles: [\n                { label: 'ÂÜôÂÆû', value: 'realistic' },\n                { label: 'Âç°ÈÄö', value: 'cartoon' },\n                { label: 'Âä®Êº´', value: 'anime' },\n                { label: 'Ê≤πÁîª', value: 'oil-painting' }\n            ],\n            generating: false\n        };\n    },\n    methods: {\n        /**\n         * ÈÄâÊã©ÂõæÁâáÔºàÂõæÁîüÂõæÊ®°ÂºèÔºâ\n         */\n        chooseImage() {\n            uni.chooseImage({\n                count: 1,\n                sizeType: ['compressed'],\n                sourceType: ['album', 'camera'],\n                success: (res) => {\n                    this.imageTempPath = res.tempFilePaths[0];\n                    // ÂÖàÊòæÁ§∫Êú¨Âú∞È¢ÑËßà\n                    this.imageUrl = this.imageTempPath;\n                    // ‰∏ä‰º†ÂõæÁâáÂà∞ÊúçÂä°Âô®Ëé∑ÂèñURL\n                    this.uploadImage();\n                },\n                fail: (err) => {\n                    console.error('ÈÄâÊã©ÂõæÁâáÂ§±Ë¥•', err);\n                    uni.showToast({\n                        title: 'ÈÄâÊã©ÂõæÁâáÂ§±Ë¥•',\n                        icon: 'none'\n                    });\n                }\n            });\n        },\n        \n        /**\n         * ‰∏ä‰º†ÂõæÁâáÂà∞ÊúçÂä°Âô®\n         */\n        async uploadImage() {\n            if (!this.imageTempPath) {\n                return;\n            }\n            \n            uni.showLoading({\n                title: '‰∏ä‰º†‰∏≠...'\n            });\n            \n            try {\n                // Ëé∑Âèñtoken\n                const token = uni.getStorageSync('token');\n                if (!token) {\n                    throw new Error('Êú™ÁôªÂΩï');\n                }\n                \n                // ‰ΩøÁî®uni.uploadFile‰∏ä‰º†ÂõæÁâá\n                const uploadRes = await new Promise((resolve, reject) => {\n                    uni.uploadFile({\n                        url: `${apiConfig.BASE_URL}/tool/upload-image`,\n                        filePath: this.imageTempPath,\n                        name: 'file',\n                        header: {\n                            'Authorization': 'Bearer ' + token\n                        },\n                        success: (res) => {\n                            try {\n                                const data = JSON.parse(res.data);\n                                if (data.code === 200) {\n                                    resolve(data);\n                                } else {\n                                    reject(new Error(data.message || '‰∏ä‰º†Â§±Ë¥•'));\n                                }\n                            } catch (e) {\n                                reject(new Error('Ëß£ÊûêÂìçÂ∫îÂ§±Ë¥•'));\n                            }\n                        },\n                        fail: reject\n                    });\n                });\n                \n                // Êõ¥Êñ∞ÂõæÁâáURL‰∏∫ÊúçÂä°Âô®ËøîÂõûÁöÑURL\n                if (uploadRes.data && uploadRes.data.imageUrl) {\n                    this.imageUrl = uploadRes.data.imageUrl;\n                }\n                \n                uni.hideLoading();\n            } catch (e) {\n                console.error('‰∏ä‰º†ÂõæÁâáÂ§±Ë¥•', e);\n                uni.hideLoading();\n                uni.showToast({\n                    title: e.message || '‰∏ä‰º†ÂõæÁâáÂ§±Ë¥•',\n                    icon: 'none'\n                });\n                // ‰∏ä‰º†Â§±Ë¥•Êó∂Ê∏ÖÁ©∫ÂõæÁâá\n                this.imageUrl = '';\n                this.imageTempPath = '';\n            }\n        },\n        \n        /**\n         * ÁîüÊàêÂ§¥ÂÉè\n         */\n        async generate() {\n            if (!this.prompt.trim()) {\n                uni.showToast({\n                    title: 'ËØ∑ËæìÂÖ•ÊèêÁ§∫ËØç',\n                    icon: 'none'\n                });\n                return;\n            }\n            \n            if (this.mode === 'image' && !this.imageUrl) {\n                uni.showToast({\n                    title: 'ËØ∑ÂÖà‰∏ä‰º†ÂõæÁâá',\n                    icon: 'none'\n                });\n                return;\n            }\n\n            this.generating = true;\n            try {\n                const requestData = {\n                    prompt: this.prompt,\n                    style: this.selectedStyle\n                };\n                \n                // ÂõæÁîüÂõæÊ®°ÂºèÔºöÊ∑ªÂä†ÂõæÁâáURL\n                if (this.mode === 'image' && this.imageUrl) {\n                    // Â¶ÇÊûúÊòØ‰∏¥Êó∂Ë∑ØÂæÑÔºåÈúÄË¶ÅÂÖà‰∏ä‰º†Âà∞ÊúçÂä°Âô®\n                    // ËøôÈáåÊöÇÊó∂‰ΩøÁî®‰∏¥Êó∂Ë∑ØÂæÑÔºåÂÆûÈôÖÂ∫îËØ•‰ΩøÁî®ÊúçÂä°Âô®ËøîÂõûÁöÑURL\n                    requestData.imageUrl = this.imageUrl;\n                }\n                \n                const res = await api.generateAiAvatar(requestData);\n                if (res.code === 200) {\n                    uni.navigateTo({\n                        url: `/pages/result/result?type=2&resultUrl=${encodeURIComponent(res.data.resultUrl)}`\n                    });\n                } else {\n                    uni.showToast({\n                        title: res.message || 'ÁîüÊàêÂ§±Ë¥•',\n                        icon: 'none'\n                    });\n                }\n            } catch (e) {\n                console.error('ÁîüÊàêÂ§±Ë¥•', e);\n                uni.showToast({\n                    title: 'ÁîüÊàêÂ§±Ë¥•ÔºåËØ∑ÈáçËØï',\n                    icon: 'none'\n                });\n            } finally {\n                this.generating = false;\n            }\n        }\n    }\n};\n</script>\n\n<style scoped>\n.container {\n    min-height: 100vh;\n    background: #f5f5f5;\n    padding: 30rpx;\n}\n\n.form-item {\n    background: #fff;\n    border-radius: 20rpx;\n    padding: 30rpx;\n    margin-bottom: 30rpx;\n}\n\n.label {\n    display: block;\n    font-size: 28rpx;\n    color: #333;\n    margin-bottom: 20rpx;\n    font-weight: 500;\n}\n\n.textarea {\n    width: 100%;\n    min-height: 200rpx;\n    background: #f5f5f5;\n    border-radius: 10rpx;\n    padding: 20rpx;\n    font-size: 28rpx;\n    box-sizing: border-box;\n}\n\n.style-options {\n    display: flex;\n    flex-wrap: wrap;\n    gap: 20rpx;\n}\n\n.style-item {\n    padding: 15rpx 30rpx;\n    background: #f5f5f5;\n    border-radius: 30rpx;\n    font-size: 26rpx;\n    color: #666;\n    border: 2rpx solid transparent;\n}\n\n.style-item.active {\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    color: #fff;\n    border-color: #667eea;\n}\n\n.generate-btn {\n    width: 100%;\n    height: 88rpx;\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    color: #fff;\n    border-radius: 44rpx;\n    font-size: 32rpx;\n    border: none;\n    margin-top: 40rpx;\n}\n\n.generate-btn[disabled] {\n    background: #ccc;\n}\n\n.mode-options {\n    display: flex;\n    gap: 20rpx;\n}\n\n.mode-item {\n    flex: 1;\n    padding: 20rpx;\n    background: #f5f5f5;\n    border-radius: 10rpx;\n    text-align: center;\n    font-size: 28rpx;\n    color: #666;\n    border: 2rpx solid transparent;\n}\n\n.mode-item.active {\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    color: #fff;\n    border-color: #667eea;\n}\n\n.upload-area {\n    width: 100%;\n    min-height: 300rpx;\n    background: #f5f5f5;\n    border-radius: 10rpx;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    border: 2rpx dashed #ddd;\n}\n\n.preview-image {\n    width: 100%;\n    max-height: 500rpx;\n    border-radius: 10rpx;\n}\n\n.upload-placeholder {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    padding: 40rpx;\n}\n\n.upload-icon {\n    font-size: 80rpx;\n    margin-bottom: 20rpx;\n}\n\n.upload-text {\n    font-size: 28rpx;\n    color: #999;\n}\n</style>\n\n\n","import MiniProgramPage from '/Users/gongxuesong/Work/individual/Â∑•ÂÖ∑/tool-ai-all/tool-ai-uniapp/pages/ai-avatar/ai-avatar.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni","apiConfig","api"],"mappings":"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"}