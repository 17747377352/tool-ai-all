{"version":3,"file":"remove-logo.js","sources":["pages/remove-logo/remove-logo.vue","pages/remove-logo/remove-logo.vue?type=page"],"sourcesContent":["<template>\n    <view class=\"container\">\n        <!-- 输入分享链接 -->\n        <view class=\"form-item\">\n            <text class=\"label\">粘贴分享链接</text>\n            <textarea\n                v-model=\"shareUrl\"\n                class=\"textarea\"\n                placeholder=\"粘贴抖音或小红书的分享链接，例如：https://v.douyin.com/xxx/\"\n                maxlength=\"500\"\n                @input=\"onShareUrlInput\"\n            ></textarea>\n            <view v-if=\"shareUrl\" class=\"link-tips\">\n                <text class=\"link-tip-text\">{{ getPlatformName() }}</text>\n            </view>\n        </view>\n\n        <view class=\"tips\">\n            <text class=\"tips-text\">支持抖音、小红书分享链接，自动去除水印</text>\n            <view v-if=\"!canUse\" class=\"ad-tip\">\n                <text class=\"ad-tip-text\">⚠️ 需观看广告后使用，观看后24小时内有效</text>\n            </view>\n            <view v-else class=\"ad-tip success\">\n                <text class=\"ad-tip-text\">✓ 已观看广告，24小时内有效</text>\n            </view>\n        </view>\n\n        <button \n            class=\"generate-btn\" \n            :disabled=\"!shareUrl || generating\" \n            @click=\"generate\"\n        >\n            {{ generating ? '处理中...' : (canUse ? '立即去水印' : '观看广告后使用') }}\n        </button>\n\n        <!-- Banner广告 -->\n        <ad-video-banner />\n    </view>\n</template>\n\n<script>\nimport api from '@/common/utils/api.js';\nimport { showRewardedVideo } from '@/common/utils/ad.js';\nimport AdVideoBanner from '@/common/components/ad-video-banner.vue';\n\nexport default {\n    components: {\n        AdVideoBanner\n    },\n    data() {\n        return {\n            shareUrl: '', // 分享链接\n            generating: false,\n            canUse: false, // 是否可以使用（24小时内观看过广告）\n            checkingAd: false // 是否正在检查广告状态\n        };\n    },\n    onLoad() {\n        this.checkAdStatus();\n    },\n    methods: {\n        /**\n         * 检查广告观看状态\n         */\n        async checkAdStatus() {\n            try {\n                const res = await api.checkRemoveLogoAd();\n                if (res.code === 200) {\n                    this.canUse = res.data.canUse || false;\n                }\n            } catch (e) {\n                console.error('检查广告状态失败', e);\n            }\n        },\n        \n        /**\n         * 观看广告\n         */\n        async watchAd() {\n            try {\n                uni.showLoading({ title: '加载广告中...' });\n                await showRewardedVideo();\n                uni.hideLoading();\n                \n                // 记录广告观看\n                const res = await api.recordAdWatch(1);\n                if (res.code === 200) {\n                    this.canUse = true;\n                    uni.showToast({\n                        title: '观看成功！24小时内可使用',\n                        icon: 'success'\n                    });\n                } else {\n                    uni.showToast({\n                        title: '记录失败，请重试',\n                        icon: 'none'\n                    });\n                }\n            } catch (e) {\n                uni.hideLoading();\n                console.error('观看广告失败', e);\n                if (e.message && !e.message.includes('广告未完整观看')) {\n                    uni.showToast({\n                        title: '观看广告失败，请重试',\n                        icon: 'none'\n                    });\n                }\n            }\n        },\n        \n        /**\n         * 分享链接输入处理\n         */\n        onShareUrlInput(e) {\n            this.shareUrl = e.detail.value;\n        },\n        \n        /**\n         * 获取平台名称\n         */\n        getPlatformName() {\n            if (!this.shareUrl) {\n                return '';\n            }\n            if (this.shareUrl.includes('douyin.com') || this.shareUrl.includes('iesdouyin.com')) {\n                return '✓ 已识别：抖音';\n            } else if (this.shareUrl.includes('xiaohongshu.com')) {\n                return '✓ 已识别：小红书';\n            }\n            return '';\n        },\n        \n        /**\n         * 去水印\n         */\n        async generate() {\n            // 检查是否需要观看广告\n            if (!this.canUse) {\n                uni.showModal({\n                    title: '提示',\n                    content: '使用此功能需要观看广告，观看后24小时内有效',\n                    confirmText: '观看广告',\n                    cancelText: '取消',\n                    success: (res) => {\n                        if (res.confirm) {\n                            this.watchAd();\n                        }\n                    }\n                });\n                return;\n            }\n            \n            await this.generateFromShareUrl();\n        },\n        \n        /**\n         * 从分享链接去水印\n         */\n        async generateFromShareUrl() {\n            if (!this.shareUrl.trim()) {\n                uni.showToast({\n                    title: '请输入分享链接',\n                    icon: 'none'\n                });\n                return;\n            }\n\n            // 简单验证链接格式\n            if (!this.shareUrl.includes('douyin.com') && \n                !this.shareUrl.includes('iesdouyin.com') && \n                !this.shareUrl.includes('xiaohongshu.com')) {\n                uni.showToast({\n                    title: '仅支持抖音和小红书链接',\n                    icon: 'none'\n                });\n                return;\n            }\n\n            this.generating = true;\n            try {\n                const res = await api.removeLogo({\n                    shareUrl: this.shareUrl.trim()\n                });\n                if (res.code === 200) {\n                    uni.navigateTo({\n                        url: `/pages/result/result?type=1&resultUrl=${encodeURIComponent(res.data.resultUrl)}`\n                    });\n                } else {\n                    // 如果是广告相关错误，更新状态\n                    if (res.message && res.message.includes('观看广告')) {\n                        this.canUse = false;\n                        await this.checkAdStatus();\n                    }\n                    uni.showToast({\n                        title: res.message || '去水印失败',\n                        icon: 'none'\n                    });\n                }\n            } catch (e) {\n                console.error('去水印失败', e);\n                // 如果是广告相关错误，更新状态\n                if (e.message && e.message.includes('观看广告')) {\n                    this.canUse = false;\n                    await this.checkAdStatus();\n                }\n                uni.showToast({\n                    title: e.message || '去水印失败，请重试',\n                    icon: 'none'\n                });\n            } finally {\n                this.generating = false;\n            }\n        }\n    }\n};\n</script>\n\n<style scoped>\n.container {\n    min-height: 100vh;\n    background: #f5f5f5;\n    padding: 30rpx;\n}\n\n.tips {\n    margin-bottom: 40rpx;\n}\n\n.tips-text {\n    font-size: 24rpx;\n    color: #999;\n}\n\n.generate-btn {\n    width: 100%;\n    height: 88rpx;\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    color: #fff;\n    border-radius: 44rpx;\n    font-size: 32rpx;\n    border: none;\n}\n\n.generate-btn[disabled] {\n    background: #ccc;\n}\n\n.form-item {\n    background: #fff;\n    border-radius: 20rpx;\n    padding: 30rpx;\n    margin-bottom: 30rpx;\n}\n\n.label {\n    display: block;\n    font-size: 28rpx;\n    color: #333;\n    margin-bottom: 20rpx;\n    font-weight: 500;\n}\n\n.textarea {\n    width: 100%;\n    min-height: 150rpx;\n    background: #f5f5f5;\n    border-radius: 10rpx;\n    padding: 20rpx;\n    font-size: 28rpx;\n    box-sizing: border-box;\n}\n\n.link-tips {\n    margin-top: 15rpx;\n}\n\n.link-tip-text {\n    font-size: 24rpx;\n    color: #667eea;\n}\n\n.ad-tip {\n    margin-top: 15rpx;\n    padding: 15rpx;\n    background: #fff3cd;\n    border-radius: 10rpx;\n    border-left: 4rpx solid #ffc107;\n}\n\n.ad-tip.success {\n    background: #d4edda;\n    border-left-color: #28a745;\n}\n\n.ad-tip-text {\n    font-size: 24rpx;\n    color: #856404;\n}\n\n.ad-tip.success .ad-tip-text {\n    color: #155724;\n}\n</style>\n\n","import MiniProgramPage from '/Users/gongxuesong/Work/individual/工具/tool-ai-all/tool-ai-uniapp/pages/remove-logo/remove-logo.vue'\nwx.createPage(MiniProgramPage)"],"names":["api","uni","showRewardedVideo"],"mappings":";;;;AA2CA,MAAO,gBAAe,MAAW;AAEjC,MAAK,YAAU;AAAA,EACX,YAAY;AAAA,IACR;AAAA,EACH;AAAA,EACD,OAAO;AACH,WAAO;AAAA,MACH,UAAU;AAAA;AAAA,MACV,YAAY;AAAA,MACZ,QAAQ;AAAA;AAAA,MACR,YAAY;AAAA;AAAA;EAEnB;AAAA,EACD,SAAS;AACL,SAAK,cAAa;AAAA,EACrB;AAAA,EACD,SAAS;AAAA;AAAA;AAAA;AAAA,IAIL,MAAM,gBAAgB;AAClB,UAAI;AACA,cAAM,MAAM,MAAMA,qBAAI;AACtB,YAAI,IAAI,SAAS,KAAK;AAClB,eAAK,SAAS,IAAI,KAAK,UAAU;AAAA,QACrC;AAAA,MACJ,SAAS,GAAG;AACRC,sBAAc,MAAA,MAAA,SAAA,2CAAA,YAAY,CAAC;AAAA,MAC/B;AAAA,IACH;AAAA;AAAA;AAAA;AAAA,IAKD,MAAM,UAAU;AACZ,UAAI;AACAA,sBAAAA,MAAI,YAAY,EAAE,OAAO,WAAY,CAAA;AACrC,cAAMC,gBAAiB,kBAAA;AACvBD,sBAAG,MAAC,YAAW;AAGf,cAAM,MAAM,MAAMD,iBAAAA,IAAI,cAAc,CAAC;AACrC,YAAI,IAAI,SAAS,KAAK;AAClB,eAAK,SAAS;AACdC,wBAAAA,MAAI,UAAU;AAAA,YACV,OAAO;AAAA,YACP,MAAM;AAAA,UACV,CAAC;AAAA,eACE;AACHA,wBAAAA,MAAI,UAAU;AAAA,YACV,OAAO;AAAA,YACP,MAAM;AAAA,UACV,CAAC;AAAA,QACL;AAAA,MACJ,SAAS,GAAG;AACRA,sBAAG,MAAC,YAAW;AACfA,sBAAA,MAAA,MAAA,SAAA,4CAAc,UAAU,CAAC;AACzB,YAAI,EAAE,WAAW,CAAC,EAAE,QAAQ,SAAS,SAAS,GAAG;AAC7CA,wBAAAA,MAAI,UAAU;AAAA,YACV,OAAO;AAAA,YACP,MAAM;AAAA,UACV,CAAC;AAAA,QACL;AAAA,MACJ;AAAA,IACH;AAAA;AAAA;AAAA;AAAA,IAKD,gBAAgB,GAAG;AACf,WAAK,WAAW,EAAE,OAAO;AAAA,IAC5B;AAAA;AAAA;AAAA;AAAA,IAKD,kBAAkB;AACd,UAAI,CAAC,KAAK,UAAU;AAChB,eAAO;AAAA,MACX;AACA,UAAI,KAAK,SAAS,SAAS,YAAY,KAAK,KAAK,SAAS,SAAS,eAAe,GAAG;AACjF,eAAO;AAAA,MACT,WAAS,KAAK,SAAS,SAAS,iBAAiB,GAAG;AAClD,eAAO;AAAA,MACX;AACA,aAAO;AAAA,IACV;AAAA;AAAA;AAAA;AAAA,IAKD,MAAM,WAAW;AAEb,UAAI,CAAC,KAAK,QAAQ;AACdA,sBAAAA,MAAI,UAAU;AAAA,UACV,OAAO;AAAA,UACP,SAAS;AAAA,UACT,aAAa;AAAA,UACb,YAAY;AAAA,UACZ,SAAS,CAAC,QAAQ;AACd,gBAAI,IAAI,SAAS;AACb,mBAAK,QAAO;AAAA,YAChB;AAAA,UACJ;AAAA,QACJ,CAAC;AACD;AAAA,MACJ;AAEA,YAAM,KAAK;IACd;AAAA;AAAA;AAAA;AAAA,IAKD,MAAM,uBAAuB;AACzB,UAAI,CAAC,KAAK,SAAS,QAAQ;AACvBA,sBAAAA,MAAI,UAAU;AAAA,UACV,OAAO;AAAA,UACP,MAAM;AAAA,QACV,CAAC;AACD;AAAA,MACJ;AAGA,UAAI,CAAC,KAAK,SAAS,SAAS,YAAY,KACpC,CAAC,KAAK,SAAS,SAAS,eAAe,KACvC,CAAC,KAAK,SAAS,SAAS,iBAAiB,GAAG;AAC5CA,sBAAAA,MAAI,UAAU;AAAA,UACV,OAAO;AAAA,UACP,MAAM;AAAA,QACV,CAAC;AACD;AAAA,MACJ;AAEA,WAAK,aAAa;AAClB,UAAI;AACA,cAAM,MAAM,MAAMD,iBAAG,IAAC,WAAW;AAAA,UAC7B,UAAU,KAAK,SAAS,KAAK;AAAA,QACjC,CAAC;AACD,YAAI,IAAI,SAAS,KAAK;AAClBC,wBAAAA,MAAI,WAAW;AAAA,YACX,KAAK,yCAAyC,mBAAmB,IAAI,KAAK,SAAS,CAAC;AAAA,UACxF,CAAC;AAAA,eACE;AAEH,cAAI,IAAI,WAAW,IAAI,QAAQ,SAAS,MAAM,GAAG;AAC7C,iBAAK,SAAS;AACd,kBAAM,KAAK;UACf;AACAA,wBAAAA,MAAI,UAAU;AAAA,YACV,OAAO,IAAI,WAAW;AAAA,YACtB,MAAM;AAAA,UACV,CAAC;AAAA,QACL;AAAA,MACJ,SAAS,GAAG;AACRA,sBAAc,MAAA,MAAA,SAAA,4CAAA,SAAS,CAAC;AAExB,YAAI,EAAE,WAAW,EAAE,QAAQ,SAAS,MAAM,GAAG;AACzC,eAAK,SAAS;AACd,gBAAM,KAAK;QACf;AACAA,sBAAAA,MAAI,UAAU;AAAA,UACV,OAAO,EAAE,WAAW;AAAA,UACpB,MAAM;AAAA,QACV,CAAC;AAAA,MACL,UAAU;AACN,aAAK,aAAa;AAAA,MACtB;AAAA,IACJ;AAAA,EACJ;AACJ;;;;;;;;;;;;;;;;;;;;;ACrNA,GAAG,WAAW,eAAe;"}