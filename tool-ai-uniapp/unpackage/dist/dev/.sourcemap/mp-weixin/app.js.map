{"version":3,"file":"app.js","sources":["App.vue","main.js"],"sourcesContent":["<template>\n    <view id=\"app\">\n    </view>\n</template>\n\n<script setup>\nimport { onLaunch, onShow, onHide } from '@dcloudio/uni-app'\nimport apiConfig from '@/common/config/api-config.js'\n\nonLaunch(() => {\n    console.log('App Launch')\n    // 初始化登录\n    initLogin()\n})\n\nonShow(() => {\n    console.log('App Show')\n})\n\nonHide(() => {\n    console.log('App Hide')\n})\n\nasync function initLogin() {\n    // 静默登录\n    try {\n        // 检查是否已有token\n        const existingToken = uni.getStorageSync('token')\n        if (existingToken) {\n            console.log('已有token，跳过登录')\n            return\n        }\n\n        const code = await getWxCode()\n        const res = await uni.request({\n            url: `${apiConfig.BASE_URL}/auth/wx-login`,\n            method: 'POST',\n            data: { code }\n        })\n        if (res.data && res.data.code === 200) {\n            uni.setStorageSync('token', res.data.data.token)\n            uni.setStorageSync('openid', res.data.data.openid)\n            console.log('登录成功，token已保存')\n        } else {\n            console.warn('登录失败:', res.data)\n        }\n    } catch (e) {\n        console.error('登录失败', e)\n    }\n}\n\nfunction getWxCode() {\n    return new Promise((resolve, reject) => {\n        uni.login({\n            provider: 'weixin',\n            success: (res) => {\n                resolve(res.code)\n            },\n            fail: reject\n        })\n    })\n}\n</script>\n\n<style>\n/*每个页面公共css */\npage {\n    background-color: #f5f5f5;\n}\n</style>\n\n","import App from './App.vue'\nimport { createSSRApp } from 'vue'\n\nexport function createApp() {\n    const app = createSSRApp(App)\n    return {\n        app\n    }\n}\n\n"],"names":["onLaunch","uni","onShow","onHide","apiConfig","createSSRApp","App"],"mappings":";;;;;;;;;;;;;;;;;;;;;AASAA,kBAAAA,SAAS,MAAM;AACXC,oBAAAA,MAAY,MAAA,OAAA,iBAAA,YAAY;AAExB,gBAAW;AAAA,IACf,CAAC;AAEDC,kBAAAA,OAAO,MAAM;AACTD,oBAAAA,MAAA,MAAA,OAAA,iBAAY,UAAU;AAAA,IAC1B,CAAC;AAEDE,kBAAAA,OAAO,MAAM;AACTF,oBAAAA,MAAA,MAAA,OAAA,iBAAY,UAAU;AAAA,IAC1B,CAAC;AAED,mBAAe,YAAY;AAEvB,UAAI;AAEA,cAAM,gBAAgBA,cAAAA,MAAI,eAAe,OAAO;AAChD,YAAI,eAAe;AACfA,wBAAAA,MAAY,MAAA,OAAA,iBAAA,cAAc;AAC1B;AAAA,QACH;AAED,cAAM,OAAO,MAAM,UAAW;AAC9B,cAAM,MAAM,MAAMA,cAAG,MAAC,QAAQ;AAAA,UAC1B,KAAK,GAAGG,kCAAU,QAAQ;AAAA,UAC1B,QAAQ;AAAA,UACR,MAAM,EAAE,KAAM;AAAA,QAC1B,CAAS;AACD,YAAI,IAAI,QAAQ,IAAI,KAAK,SAAS,KAAK;AACnCH,wBAAG,MAAC,eAAe,SAAS,IAAI,KAAK,KAAK,KAAK;AAC/CA,wBAAG,MAAC,eAAe,UAAU,IAAI,KAAK,KAAK,MAAM;AACjDA,wBAAAA,MAAY,MAAA,OAAA,iBAAA,eAAe;AAAA,QACvC,OAAe;AACHA,wBAAA,MAAA,MAAA,QAAA,iBAAa,SAAS,IAAI,IAAI;AAAA,QACjC;AAAA,MACJ,SAAQ,GAAG;AACRA,sBAAAA,MAAA,MAAA,SAAA,iBAAc,QAAQ,CAAC;AAAA,MAC1B;AAAA,IACL;AAEA,aAAS,YAAY;AACjB,aAAO,IAAI,QAAQ,CAAC,SAAS,WAAW;AACpCA,sBAAAA,MAAI,MAAM;AAAA,UACN,UAAU;AAAA,UACV,SAAS,CAAC,QAAQ;AACd,oBAAQ,IAAI,IAAI;AAAA,UACnB;AAAA,UACD,MAAM;AAAA,QAClB,CAAS;AAAA,MACT,CAAK;AAAA,IACL;;;;;;AC1DO,SAAS,YAAY;AACxB,QAAM,MAAMI,cAAY,aAACC,SAAG;AAC5B,SAAO;AAAA,IACH;AAAA,EACH;AACL;AAGA,YAAY,IAAI,MAAM,MAAM;;"}